@import "tailwindcss";

/* Import Apple-inspired design tokens */
@import "../styles/tokens.css";

/* Light theme variables */
:root {
  /* Base colors */
  --background: #fafafa;
  --foreground: #1a1a1a;
  --font-vazirmatn: "Vazirmatn", sans-serif;

  /* Surface colors (backgrounds at different elevations) */
  --section-background: 248 248 248; /* Slightly darker than background, lighter than surface */
  --surface: 255 255 255;
  --surface-secondary: 249 250 251;
  --surface-tertiary: 243 244 246;

  /* Border colors */
  --border: 229 231 235;
  --border-secondary: 209 213 219;

  /* Text colors */
  --text-primary: 17 24 39;
  --text-secondary: 75 85 99;
  --text-tertiary: 107 114 128;

  /* Single Accent Color - Blue (Apple-style unified system) */
  --accent-blue-50: 239 246 255;
  --accent-blue-100: 219 234 254;
  --accent-blue-500: 59 130 246;
  --accent-blue-600: 37 99 235;
  --accent-blue-700: 29 78 216;

  /* Status colors */
  --success-bg: 240 253 244;
  --success-text: 22 101 52;
  --error-bg: 254 242 242;
  --error-text: 153 27 27;
  --warning-bg: 254 252 232;
  --warning-text: 161 98 7;
}

/* Dark mode variables - class-based dark mode */
.dark {
  /* Base colors */
  --background: #000000;  /* Pure black for deepest hierarchy level */
  --foreground: #f0f0f0;

  /* Surface colors (backgrounds at different elevations) - Using iOS design tokens */
  --section-background: 28 28 30; /* gray-6 - Subtle elevation above pure black */
  --surface: 28 28 30;           /* gray-6 - Cards and elevated surfaces */
  --surface-secondary: 44 44 46; /* gray-5 - Secondary elevation/hover states */
  --surface-tertiary: 58 58 60;  /* gray-4 - Tertiary elevation */

  /* Border colors - More visible for dark mode */
  --border: 72 72 74;            /* gray-3 - Visible borders on dark surfaces */
  --border-secondary: 99 99 102; /* gray-2 - Secondary borders */

  /* Text colors */
  --text-primary: 243 244 246;
  --text-secondary: 209 213 219;
  --text-tertiary: 156 163 175;

  /* Single Accent Color - Blue (Apple-style unified system, brighter for dark mode) */
  --accent-blue-50: 30 41 59;
  --accent-blue-100: 51 65 85;
  --accent-blue-500: 96 165 250;    /* blue-400 - brighter */
  --accent-blue-600: 59 130 246;    /* blue-500 - brighter */
  --accent-blue-700: 37 99 235;     /* blue-600 - brighter */

  /* Status colors - dark mode variants with proper contrast */
  --success-bg: 20 83 45;
  --success-text: 134 239 172;
  --error-bg: 127 29 29;
  --error-text: 252 165 165;
  --warning-bg: 113 63 18;
  --warning-text: 253 224 71;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-vazirmatn);

  /* ============================================================================
     Apple Design Token Integration
     Map design tokens to Tailwind-compatible custom properties
     ============================================================================ */

  /* Background System - Layered Hierarchy */
  --color-background-base: var(--background-base);
  --color-bg-base: var(--background-base);
  --color-bg-elevated: var(--background-elevated);
  --color-bg-secondary: var(--background-secondary);
  --color-bg-tertiary: var(--background-tertiary);

  --color-background-elevated: var(--background-elevated);
  --color-background-secondary: var(--background-secondary);
  --color-background-tertiary: var(--background-tertiary);

  /* Hover states for elevated surfaces */
  --color-bg-elevated-hover: var(--background-secondary);

  /* Legacy surface colors for gradual migration */
  --color-section-background: rgb(var(--section-background));
  --color-surface: var(--background-elevated);
  --color-surface-secondary: var(--background-secondary);
  --color-surface-tertiary: var(--background-tertiary);

  /* Text Hierarchy - WCAG AAA Compliant */
  --color-text-primary: rgb(var(--text-primary));
  --color-text-secondary: rgb(var(--text-secondary));
  --color-text-tertiary: rgb(var(--text-tertiary));
  --color-text-quaternary: rgb(var(--text-quaternary));

  /* Primary Accent - SF Blue (Single accent system) */
  --color-accent: rgb(var(--accent-primary));
  --color-accent-hover: rgb(var(--accent-primary-hover));
  --color-accent-primary: rgb(var(--accent-primary));
  --color-accent-primary-hover: rgb(var(--accent-primary-hover));
  --color-accent-primary-active: rgb(var(--accent-primary-active));
  --color-accent-primary-subtle: var(--accent-primary-subtle);

  /* Border System */
  --color-border: rgb(var(--border-light));
  --color-border-light: rgb(var(--border-light));
  --color-border-secondary: rgb(var(--border-medium));
  --color-border-heavy: rgb(var(--border-heavy));
  --color-border-focus: rgb(var(--border-focus));

  /* Semantic Status Colors */
  --color-success: rgb(var(--success));
  --color-success-bg: var(--success-bg);
  --color-success-text: var(--success-text);

  --color-error: rgb(var(--error));
  --color-error-bg: var(--error-bg);
  --color-error-text: var(--error-text);

  --color-warning: rgb(var(--warning));
  --color-warning-bg: var(--warning-bg);
  --color-warning-text: var(--warning-text);

  --color-info: rgb(var(--info));
  --color-info-bg: var(--info-bg);
  --color-info-text: var(--info-text);

  /* Spacing tokens for Tailwind utilities */
  --space-card-padding: var(--space-card);
  --space-button-padding-x: var(--space-button-x);
  --space-button-padding-y: var(--space-button-y);

  /* Border radius tokens */
  --radius-apple-card: var(--radius-card);
  --radius-apple-button: var(--radius-button);
  --radius-apple-input: var(--radius-input);

  /* Shadow tokens */
  --shadow-card: var(--shadow-sm);
  --shadow-card-hover: var(--shadow-md);

  /* Shimmer animation for loading skeletons */
  --animate-shimmer: shimmer 2s infinite;

  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }
    100% {
      background-position: 1000px 0;
    }
  }
}

/* Fallback for system preference dark mode */
@media (prefers-color-scheme: dark) {
  :root:not(.light) {
    --background: #000000;  /* Pure black for deepest hierarchy level */
    --foreground: #f0f0f0;

    --section-background: 28 28 30; /* gray-6 - Subtle elevation above pure black */
    --surface: 28 28 30;           /* gray-6 - Cards and elevated surfaces */
    --surface-secondary: 44 44 46; /* gray-5 - Secondary elevation/hover states */
    --surface-tertiary: 58 58 60;  /* gray-4 - Tertiary elevation */

    --border: 72 72 74;            /* gray-3 - Visible borders on dark surfaces */
    --border-secondary: 99 99 102; /* gray-2 - Secondary borders */

    --text-primary: 243 244 246;
    --text-secondary: 209 213 219;
    --text-tertiary: 156 163 175;

    --accent-blue-50: 30 41 59;
    --accent-blue-100: 51 65 85;
    --accent-blue-500: 96 165 250;
    --accent-blue-600: 59 130 246;
    --accent-blue-700: 37 99 235;

    --success-bg: 20 83 45;
    --success-text: 134 239 172;
    --error-bg: 127 29 29;
    --error-text: 252 165 165;
    --warning-bg: 113 63 18;
    --warning-text: 253 224 71;
  }
}

body {
  background: var(--background-base, var(--background));
  color: var(--foreground);
  font-family: var(--font-vazirmatn), -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;

  /* Professional typography settings for Persian text */
  font-feature-settings: "kern" 1, "liga" 1;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: var(--font-regular, 400);
  line-height: 1.7;
  letter-spacing: var(--tracking-normal, -0.01em);

  /* Smooth transitions for theme changes */
  transition: background-color var(--duration-normal, 200ms) var(--ease-default, ease),
              color var(--duration-normal, 200ms) var(--ease-default, ease);
}

/* Enhanced readability for headings */
h1, h2, h3, h4, h5, h6 {
  font-weight: var(--font-semibold, 600);
  line-height: 1.3;
  letter-spacing: var(--tracking-tight, -0.02em);
}

/* Better number rendering for Persian numerals */
.tabular-nums {
  font-feature-settings: "tnum" 1;
  font-variant-numeric: tabular-nums;
}

/* Screen reader only utility class for accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Optimize touch interactions for mobile devices */
button, a, [role="button"] {
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

/* ============================================================================
   CUSTOM UTILITY CLASSES - Apple-Inspired Design System
   ============================================================================
   Reusable component patterns built on design tokens.
   These utilities encapsulate common Apple-style patterns.
============================================================================ */

@layer utilities {
  /* Typography Utilities - Apple-style text patterns */

  /* ============================================================================
     Typography Scale - SF Pro Inspired
     Complete token-based typography system for consistent text styling

     Usage Guide:
     - .text-apple-display: Large hero text (34px+), responsive scaling
     - .text-apple-headline: Section headings (28px+), responsive scaling
     - .text-apple-large-title: Page titles (34px), fixed size
     - .text-apple-title: Card/component titles (22px)
     - .text-apple-body: Body text (17px - iOS default)
     - .text-apple-caption: Small text, labels (13px)

     Design Token Reference (from tokens.css):
     --text-4xl: 34px / 41px (Large Title)
     --text-3xl: 28px / 34px (Title 1)
     --text-2xl: 22px / 28px (Title 2)
     --text-xl: 20px / 24px (Title 3)
     --text-lg: 17px / 22px (Body - iOS default)
     --text-sm: 13px / 18px (Caption 1)
  ============================================================================ */

  .text-apple-display {
    font-size: var(--text-4xl); /* 34px */
    line-height: 1.2;
    font-weight: var(--font-semibold);
    letter-spacing: -0.02em;
  }

  .text-apple-headline {
    font-size: var(--text-3xl); /* 28px */
    line-height: 1.2;
    font-weight: var(--font-semibold);
    letter-spacing: -0.02em;
  }

  .text-apple-title {
    font-size: var(--text-2xl);
    line-height: var(--text-2xl-lh);
    font-weight: var(--font-semibold);
    letter-spacing: var(--tracking-tight);
  }

  .text-apple-large-title {
    font-size: var(--text-4xl);
    line-height: var(--text-4xl-lh);
    font-weight: var(--font-semibold);
    letter-spacing: var(--tracking-tight);
  }

  .text-apple-body {
    font-size: var(--text-lg);
    line-height: var(--text-lg-lh);
    font-weight: var(--font-regular);
  }

  .text-apple-caption {
    font-size: var(--text-sm);
    line-height: var(--text-sm-lh);
    font-weight: var(--font-regular);
  }

  /* ============================================================================
     Responsive Typography Variants
     Scale display and headline text across breakpoints for optimal readability
  ============================================================================ */

  /* Small devices (640px+): Standard sizes */
  @media (min-width: 640px) {
    .text-apple-display {
      font-size: var(--text-4xl);
    }
  }

  /* Medium devices (768px+): 10% larger for better readability */
  @media (min-width: 768px) {
    .text-apple-display {
      font-size: calc(var(--text-4xl) * 1.1);
    }

    .text-apple-headline {
      font-size: calc(var(--text-3xl) * 1.1);
    }
  }

  /* Card Utilities - Apple-style card components */
  .card-apple {
    background: var(--background-elevated);
    border-radius: var(--radius-card);
    box-shadow: var(--shadow-sm);
    /* Note: Padding is now controlled per-component for more granular control */
    /* Compact mode (2-column): p-3 (12px) */
    /* Normal mode (1-column): p-4 (16px) */
    border: 1px solid rgb(var(--border-light));
    transition: var(--transition-default);
  }

  .card-apple:hover {
    box-shadow: var(--shadow-md);
    background: var(--background-secondary);
    transform: translateY(-2px);
  }

  /* Respect accessibility preference */
  @media (prefers-reduced-motion: reduce) {
    .card-apple:hover {
      transform: none;
    }
  }

  /* Button Utilities - Apple-style button variants */
  .btn-apple-filled {
    background: rgb(var(--accent-primary));
    color: white;
    border-radius: var(--radius-button);
    padding: var(--space-button-y) var(--space-button-x);
    font-weight: var(--font-medium);
    transition: var(--transition-colors);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }

  .btn-apple-filled:hover:not(:disabled) {
    background: rgb(var(--accent-primary-hover));
  }

  .btn-apple-tinted {
    background: var(--accent-primary-subtle);
    color: rgb(var(--accent-primary));
    border-radius: var(--radius-button);
    padding: var(--space-button-y) var(--space-button-x);
    font-weight: var(--font-medium);
    transition: var(--transition-colors);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }

  .btn-apple-tinted:hover:not(:disabled) {
    opacity: 0.8;
  }

  .btn-apple-gray {
    background: rgb(var(--gray-5));
    color: rgb(var(--text-primary));
    border-radius: var(--radius-button);
    padding: var(--space-button-y) var(--space-button-x);
    font-weight: var(--font-medium);
    transition: var(--transition-colors);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }

  .btn-apple-gray:hover:not(:disabled) {
    background: rgb(var(--gray-4));
  }

  /* Badge Utilities - Subtle status indicators */
  .badge-apple-success {
    background: var(--success-bg);
    color: var(--success-text);
    border-radius: var(--radius-sm);
    padding: var(--space-1) var(--space-2);
    font-size: var(--text-sm);
    line-height: var(--text-sm-lh);
    font-weight: var(--font-medium);
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
  }

  .badge-apple-error {
    background: var(--error-bg);
    color: var(--error-text);
    border-radius: var(--radius-sm);
    padding: var(--space-1) var(--space-2);
    font-size: var(--text-sm);
    line-height: var(--text-sm-lh);
    font-weight: var(--font-medium);
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
  }

  /* ============================================================================
     Pill-Style Status Badges - Enhanced Design for ItemCard
     More prominent, rounded pills with better visual hierarchy
     Based on Apple HIG principles with full rounded corners
  ============================================================================ */

  /* Success pill - positive percentage change */
  .badge-pill-success {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem; /* space-1 */
    border-radius: var(--radius-full);
    padding: 0.375rem 0.75rem; /* py-1.5 px-3 */
    font-size: var(--text-sm); /* 13px */
    line-height: 1.2;
    font-weight: var(--font-semibold);
    white-space: nowrap;

    /* Success colors with opacity backgrounds for depth */
    background: rgba(var(--success), 0.1);
    color: rgb(var(--success));

    /* Subtle ring border for definition */
    box-shadow: 0 0 0 1px rgba(var(--success), 0.2) inset;

    /* Smooth transition */
    transition: var(--transition-colors);
  }

  /* Success pill dark mode - brighter background for visibility */
  .dark .badge-pill-success {
    background: rgba(var(--success), 0.2);
    box-shadow: 0 0 0 1px rgba(var(--success), 0.3) inset;
  }

  /* Error pill - negative percentage change */
  .badge-pill-error {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem; /* space-1 */
    border-radius: var(--radius-full);
    padding: 0.375rem 0.75rem; /* py-1.5 px-3 */
    font-size: var(--text-sm); /* 13px */
    line-height: 1.2;
    font-weight: var(--font-semibold);
    white-space: nowrap;

    /* Error colors with opacity backgrounds for depth */
    background: rgba(var(--error), 0.1);
    color: rgb(var(--error));

    /* Subtle ring border for definition */
    box-shadow: 0 0 0 1px rgba(var(--error), 0.2) inset;

    /* Smooth transition */
    transition: var(--transition-colors);
  }

  /* Error pill dark mode - brighter background for visibility */
  .dark .badge-pill-error {
    background: rgba(var(--error), 0.2);
    box-shadow: 0 0 0 1px rgba(var(--error), 0.3) inset;
  }

  /* Compact mode variants - slightly smaller for dense layouts */
  .badge-pill-success-compact {
    padding: 0.25rem 0.625rem; /* py-1 px-2.5 */
    font-size: 0.75rem; /* text-xs - 12px */
    gap: 0.1875rem; /* slightly tighter gap */
  }

  .badge-pill-error-compact {
    padding: 0.25rem 0.625rem; /* py-1 px-2.5 */
    font-size: 0.75rem; /* text-xs - 12px */
    gap: 0.1875rem; /* slightly tighter gap */
  }

  /* Hover effects for interactive contexts (if needed) */
  button:hover .badge-pill-success,
  a:hover .badge-pill-success {
    background: rgba(var(--success), 0.15);
  }

  button:hover .badge-pill-error,
  a:hover .badge-pill-error {
    background: rgba(var(--error), 0.15);
  }

  .dark button:hover .badge-pill-success,
  .dark a:hover .badge-pill-success {
    background: rgba(var(--success), 0.25);
  }

  .dark button:hover .badge-pill-error,
  .dark a:hover .badge-pill-error {
    background: rgba(var(--error), 0.25);
  }

  /* Accessibility - respect motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .badge-pill-success,
    .badge-pill-error {
      transition: none;
    }
  }

  /* Focus Ring - Consistent focus states */
  .focus-apple {
    outline: none;
    box-shadow: 0 0 0 var(--focus-ring-width) rgba(var(--accent-primary), 0.4);
    outline-offset: var(--focus-ring-offset);
  }

  /* Surface Elevation - Background layers */
  .surface-elevated {
    background: var(--background-elevated);
  }

  .surface-secondary {
    background: var(--background-secondary);
  }

  .surface-tertiary {
    background: var(--background-tertiary);
  }

  /* ============================================================================
     Apple-style Animation Utilities
     Smooth, refined animations using design token timing
  ============================================================================ */

  /* Smooth transitions - use design token timing */
  .transition-apple {
    transition: var(--transition-all);
  }

  .transition-apple-fast {
    transition-property: all;
    transition-duration: var(--duration-fast);
    transition-timing-function: var(--ease-out);
  }

  .transition-apple-colors {
    transition: var(--transition-colors);
  }

  /* Fade in animation - subtle entrance */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fadeIn var(--duration-normal) var(--ease-out);
  }

  /* Slide down animation - for dropdowns and modals */
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-slide-down {
    animation: slideDown var(--duration-normal) var(--ease-out);
  }

  /* Slide up animation - for bottom sheets */
  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(24px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-slide-up {
    animation: slideUp var(--duration-normal) var(--ease-out);
  }

  /* Active scale for interactive elements */
  .active-scale-apple {
    transition: transform var(--duration-fast) var(--ease-out);
  }

  .active-scale-apple:active {
    transform: scale(0.98);
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .transition-apple,
    .transition-apple-fast,
    .transition-apple-colors,
    .active-scale-apple {
      transition: none;
    }

    .animate-fade-in,
    .animate-slide-down,
    .animate-slide-up {
      animation: none;
    }
  }

  /* ============================================================================
     Shimmer Animation for Skeleton Loading States
     Replaces inline styles with Tailwind utility class for consistency
  ============================================================================ */

  /* Shimmer keyframes - smooth gradient sweep for loading skeletons */
  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }
    100% {
      background-position: 1000px 0;
    }
  }

  /* Shimmer background utility - light mode */
  .shimmer-bg {
    background: linear-gradient(
      90deg,
      rgb(var(--gray-5)) 0%,
      rgb(var(--gray-4)) 50%,
      rgb(var(--gray-5)) 100%
    );
    background-size: 1000px 100%;
    animation: shimmer 2s infinite ease-in-out;
  }

  /* Dark mode shimmer - uses darker grays for better contrast */
  .dark .shimmer-bg {
    background: linear-gradient(
      90deg,
      rgb(var(--gray-6)) 0%,
      rgb(var(--gray-5)) 50%,
      rgb(var(--gray-6)) 100%
    );
  }

  /* Respect motion preferences - disable animation for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .shimmer-bg {
      animation: none;
      background: rgb(var(--gray-5));
    }
  }

  /* ============================================================================
     Pulse-Once Animation for Bottom Sheet Handle
     Subtle attention-drawing animation that runs once when sheet opens
  ============================================================================ */

  /* Pulse-once keyframes - subtle opacity and scale change */
  @keyframes pulse-once {
    0% {
      opacity: 0.6;
      transform: scaleX(1);
    }
    50% {
      opacity: 1;
      transform: scaleX(1.1);
    }
    100% {
      opacity: 0.6;
      transform: scaleX(1);
    }
  }

  /* Pulse-once animation utility - draws attention to drag handle */
  .animate-pulse-once {
    animation: pulse-once 600ms ease-out;
    animation-fill-mode: both;
  }

  /* Respect motion preferences - disable animation for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .animate-pulse-once {
      animation: none;
    }
  }

  /* ============================================================================
     Success State Animations
     Smooth fade in/out animations for success notifications
  ============================================================================ */

  /* Success fade-in keyframes - enter from top with fade */
  @keyframes success-fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Success fade-out keyframes - exit to top with fade */
  @keyframes success-fade-out {
    from {
      opacity: 1;
      transform: translateY(0);
    }
    to {
      opacity: 0;
      transform: translateY(-10px);
    }
  }

  /* Success fade-in animation utility */
  .animate-success-in {
    animation: success-fade-in 300ms ease-out;
  }

  /* Success fade-out animation utility */
  .animate-success-out {
    animation: success-fade-out 300ms ease-in;
  }

  /* Respect motion preferences - disable success animations for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .animate-success-in,
    .animate-success-out {
      animation: none;
    }
  }
}
